<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ภาควิชาภาษาต่างประเทศ มหาวิทยาลัยเกษตรศาสตร์</title>
<link rel="stylesheet" href="../styles/style.css" />

</head>
<body data-course-id="ENG321" data-page-type="statistics">

    <div class="top-bar"></div>

    <header class="main-header">

        <div class="logo-container">
            <div class="logo-left">
                <img src="../img/KU-logo-th.png" alt="KU Logo" class="logo-img" />
                <div class="logo-text">
                    <div class="logo-title" data-th="ภาควิชาภาษาต่างประเทศ" data-en="Department of Foreign Languages">ภาควิชาภาษาต่างประเทศ</div>
                    <div class="logo-subtitle" data-th="คณะมนุษยศาสตร์ มหาวิทยาลัยเกษตรศาสตร์" data-en="Faculty of Humanities Kasetsart University">คณะมนุษยศาสตร์ มหาวิทยาลัยเกษตรศาสตร์</div>
                </div>
            </div>

            <div class="lang-toggle">
                <img src="../img/thai-flag.webp" alt="Thai" class="flag" id="thai-flag" />
                <img src="../img/uk-flag.png" alt="English" class="flag" id="english-flag" />
            </div>
        </div>

        <img src="../img/Banner.jpg" alt="Banner Image" class="full-banner" />

    </header>

    <main>
        <div class="main-border-wrapper">
            <div class="main-border-content">
                <div class="button-column">
                    <h1 class="section-header" data-th="ดูสถิติ: ENG 321" data-en="View Statistics: ENG 321">ดูสถิติ: ENG 321</h1>
                    <div class="section-select-wrapper">
                        <label for="sectionSelect" class="section-select-label" data-th="" data-en="">เลือกส่วนชั้นเรียน</label>
                        <select id="sectionSelect" class="section-select">
                            <option value="" disabled selected data-th="" data-en="">เลือกส่วนชั้นเรียน</option>
                            <!-- options 1 to 40 will be added by JS -->
                        </select>
                    </div>
                </div>

                <!-- Grade Statistics Box -->
                <div id="statisticsBox" class="statisticsBox" style="display:none;">
                    <h2 data-th="สถิติเกรด" data-en="Grade Statistics">สถิติเกรด</h2>
                    <div id="statisticsContainer" class="statisticsContainer"></div>
                </div>

                <!-- Attendance Statistics Box -->
                <div id="attendance-statistics-box" class="statisticsBox" style="display: none;">
                    <h2 data-th="สถิติการเข้าร่วม" data-en="Attendance Statistics">สถิติการเข้าร่วม</h2>
                    <canvas id="attendanceLineChart" width="600" height="300"></canvas> 
                </div>

                <!-- Tally Table -->
                <div id="tallyBarChartContainer" class="statisticsBox" style="display: none;">
                    <h2 data-th="สถิติรวม" data-en="Tally Statistics">สถิติรวม</h2>
                    <canvas id="tallyBarChart" width="600" height="300"></canvas>
                </div>




                





                


                
                


            </div>
        </div>

        <div class="button-row-wrapper">
            <a href="../index.html" class="styled-button" data-th="กลับหน้าแรก" data-en="Return Home">กลับหน้าแรก</a>
            

            <div class="spinner-overlay hidden" id="spinnerOverlay">
                <div class="spinner-content">
                    <img src="../img/KU-logo-th.png" alt="Loading..." class="spinner-image" />
                    <p class="spinner-text" id="spinnerText">Saving Data...</p>
                </div>
            </div>
        </div>

        <div class="export-button-wrapper">
            <button id="exportStatisticsExcelBtn" class="styled-button export-button" data-th="ส่งออกข้อมูลการนับไปยัง PDF" data-en="Export Staistical Data to PDF">ส่งออกข้อมูลการนับไปยัง PDF</button>
        </div>

    </main>

    <footer class="footer-layout">
        <img src="../img/KU-logo-eng.png" alt="Left Image" class="side-image" />
        <img src="../img/faculty-humanities.png" alt="Center Image" class="center-image" />
        <img src="../img/KU-logo-th.png" alt="Right Image" class="side-image" />
    </footer>
    <div class="top-bar"></div>

    <script>
        window.currentCourse = "ENG321";  // Change course per page!!!
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://unpkg.com/xlsx-populate/browser/xlsx-populate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>


    <script src="../scripts/scripts.js"></script>
</body>
</html>
